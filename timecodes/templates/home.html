{% load static %}
<html>
<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="{% static 'css/hbguy.css' %}">
</head>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
  	<h1>РЗВРТные таймкоды</h1>
    <div class="dropdown">
		  <button onclick="myFunction()" class="dropbtn">Создать новое</button>
		  <div id="myDropdown" class="dropdown-content">
		  	<form action="" method="post" enctype="multipart/form-data" id="form">
		  	{% csrf_token %}
		    <a href="#" id="utro">Утренний</a>
		    <a href="#" id="noch">Ночной</a>
		    <a href="#" id="glaza">В глаза посмотреть</a>
		    <a href="#" id="other">Другое</a>
		    <input type="hidden" name="myparam" value="" />
			</form>
  			</div>
		</div>
  </div>
</nav>
<div class="container">
	
</div>

<h2>Архив</h2>
<div class="row row-cols-1 row-cols-md-3 g-4">
	{% for timecode in timecodes %}
	<div v-for="timecode in timecodes" class="col">
		<div class="card">
			<a href="{% url 'td' timecode.category timecode.pageId %}">
		        <img class="card-img-top" src="{{ timecode.image }}"/>
		        <div class="card-body">
	      			<h5 class="card-title fw-bold">{{ timecode.title }}</h5>
	      		</div>
      		</a>
      		<a class="btn btn-danger"
	              href="{% url 'deleteCode' timecode.pageId %}">
	              Delete
            </a>

      	</div>
    </div>
    {% endfor %}
</div>
<script type="text/javascript">

	function myFunction() {
	  document.getElementById("myDropdown").classList.toggle("show");
	}

	// Close the dropdown menu if the user clicks outside of it
	window.onclick = function(event) {
	  if (!event.target.matches('.dropbtn')) {
	    var dropdowns = document.getElementsByClassName("dropdown-content");
	    var i;
	    for (i = 0; i < dropdowns.length; i++) {
	      var openDropdown = dropdowns[i];
	      if (openDropdown.classList.contains('show')) {
	        openDropdown.classList.remove('show');
	      }
	    }
	  }
	}
	document.querySelectorAll("form a").forEach(i => {
		i.addEventListener("click", event => {
			event.preventDefault(); // предотвращаем обновление страницыs
			form = document.querySelector("#form");
			if(event.currentTarget.id == "utro") form.querySelector("input").value = "Утренний";
			else if(event.currentTarget.id == "noch") form.querySelector("input").value = "Ночной";
			else if(event.currentTarget.id == "glaza") form.querySelector("input").value = "В глаза посмотреть";
			else if(event.currentTarget.id == "other") form.querySelector("input").value = "Другое";
			form.submit();
		});
	});
</script>
</html>